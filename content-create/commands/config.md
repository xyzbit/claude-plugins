---
name: content:config
description: 交互式配置向导 - 快速设置 content-create 插件
allowed-tools:
  - Read
  - Write
  - AskUserQuestion
  - Bash
---

# 配置向导

欢迎使用 content-create 插件配置向导！我会一步步引导你完成配置，不用担心复杂的参数。

## 第一步：检查配置文件

配置文件路径：`.claude/content-create.local.md`

**检查配置文件是否存在**：
- 如果存在：询问用户是要「查看当前配置」还是「修改配置」
- 如果不存在：自动创建配置文件

### 配置文件不存在时

执行以下操作：

1. **创建配置目录和文件**
```bash
mkdir -p .claude
cp ~/.claude/plugins/content-create/templates/content-create.local.md .claude/
```

2. **显示欢迎信息**
```
✅ 配置文件已创建！

现在让我们一步步设置你的配置。整个过程大约需要 2-3 分钟。
```

3. **进入配置向导流程**

## 第二步：配置 RSS 源

RSS 源用于收集热点话题，是内容创作的灵感来源。

**使用 AskUserQuestion 询问**：

```
问题：你想从哪些渠道获取灵感？

选项：
1. 使用默认 RSS 源（推荐）
   - 包含：AI产品洞察日报、AI创业者博客等 3 个优质源

2. 自定义 RSS 源
   - 我会帮你一个个添加

3. 暂时跳过
   - 稍后可以手动配置
```

**如果选择「使用默认 RSS 源」**：
- 保持模板文件中的默认配置
- 显示：`✅ 已配置 3 个默认 RSS 源`

**如果选择「自定义 RSS 源」**：
- 询问：`请输入 RSS 源名称（例如：极客公园）`
- 询问：`请输入 RSS 源 URL（例如：https://example.com/rss.xml）`
- 添加到配置后，询问：`是否继续添加其他 RSS 源？`
- 重复直到用户选择「不再添加」

**如果选择「暂时跳过」**：
- 清空 rss_sources 为空数组
- 显示提示：`⚠️ RSS 源为空，后续可以通过编辑 .claude/content-create.local.md 添加`

## 第三步：配置路径

工作路径决定了文章保存的位置。

**使用 AskUserQuestion 询问**：

```
问题：文章保存在哪个目录？

选项：
1. 使用默认路径（推荐）
   - article/ 目录

2. 自定义路径
   - 指定一个项目中的目录
```

**如果选择「使用默认路径」**：
- 保持默认配置：workspace_root: "article"
- 检查目录是否存在，不存在则创建
```bash
mkdir -p article/style_references/article
```
- 显示：`✅ 工作目录设置为 article/`

**如果选择「自定义路径」**：
- 询问：`请输入目录路径（相对于项目根目录）`
- 更新配置
- 创建目录
- 显示：`✅ 工作目录设置为 {路径}/`

**关于风格参考**：
```
💡 提示：放 2-3 篇你喜欢的文章到这个目录，AI 会学习你的写作风格：
   {workspace_root}/style_references/article/

稍后你可以把参考文章复制进去，也可以使用我们提供的示例文章：
   1. 远程项目：https://github.com/xyzbit/claude-plugins
   2. 本地插件缓存：.claude/plugins/cache/claude-plugins/content-create/1.0.0/templates/style_references/article
```

## 第四步：配置发布平台

选择你想要发布内容的平台。

**使用 AskUserQuestion（多选）询问**：

```
问题：你想发布到哪些平台？（可多选）

选项：
1. 微信公众号
   - 需要配置：App ID 和 App Secret

2. 小红书
   - 需要配置：相关 API 密钥

3. 飞书
   - 需要配置：应用 ID、应用 Secret、飞书群聊 ID 和 飞书消息卡片模板文件路径
```

**根据用户选择**：
- 启用对应平台的 enabled: true
- 未选择的平台设为 enabled: false
- 所有平台的 auto_publish 默认设为 false（安全起见）

**对于每个启用的平台，询问是否自动发布**：

```
问题：{平台名称} - 是否自动发布？

说明：
- 启用自动发布：生成内容后直接发布到平台
- 关闭自动发布：生成内容后需要手动确认发布

选项：
1. 关闭自动发布（默认）
   - 发布前可以先检查内容

2. 启用自动发布
   - 完全自动化
```

## 第五步：API 密钥配置

**显示信息**：

```
🔐 API 密钥配置

检测到以下平台需要 API 密钥：

{根据启用的平台列出}
- Minimax（图片/视频生成）可选（如果未配置，则不会生成图片/视频）
- 微信公众号（如果启用）
- 飞书（如果启用）

为了安全，API 密钥应该通过环境变量配置。
```

**使用 AskUserQuestion 询问**：

```
问题：根据您配置的平台，您需要补充 API 密钥，请选择：

选项：
1. 查看环境变量配置方式(更安全)
   - 我会告诉你如何通过环境变量方式配置 API 密钥

2. 查看mcp.json 文件配置方式(更简单)
   - 我会告诉你如何通过直接修改 mcp.json 文件方式配置 API 密钥

2. 暂时跳过
   - 稍后可以自行配置
```

**如果选择「查看环境变量配置方式」**：

显示详细的环境变量配置教程：

```markdown
## 环境变量配置教程

### 步骤 1：打开配置文件

根据你的 Shell 类型，编辑对应文件：

**Bash 用户**：
```bash
nano ~/.bashrc
```

**Zsh 用户**（macOS 默认）：
```bash
nano ~/.zshrc
```

### 步骤 2：添加环境变量

将以下内容添加到文件末尾：

```bash
# Content-Create 插件 API 密钥

{根据启用的平台生成对应的环境变量模板}

# Minimax（图片/视频生成）
export MINIMAX_API_KEY="your-key-here"
export MINIMAX_API_HOST="https://api.minimaxi.com"

# 微信公众号（如果启用）
export WECHAT_APP_ID="your-app-id"
export WECHAT_APP_SECRET="your-app-secret"

# 飞书（如果启用）
export LARK_APP_ID="your-app-id"
export LARK_APP_SECRET="your-app-secret"
```

**如果选择「查看mcp.json 文件配置方式」**：

显示详细的环境变量配置教程：

```markdown
打开 
```

### 步骤 3：使配置生效

保存文件后，运行：

```bash
source ~/.bashrc  # 或 source ~/.zshrc
```

### 步骤 4：获取 API 密钥

{根据启用的平台，提供对应的获取链接和说明}

**Minimax**：
- 访问：https://www.minimaxi.com/
- 注册并在控制台获取 API Key

**微信公众号**：
- 访问：https://mp.weixin.qq.com/
- 开发 > 基本配置 > AppID/AppSecret

**飞书**：
- 访问：https://open.feishu.cn/
- 创建企业自建应用获取凭证

### 验证配置

配置完成后，运行以下命令验证：

```bash
echo $MINIMAX_API_KEY
```

应该能看到你的密钥（不是 "your-key-here"）。

---

💡 提示：不用担心现在不配置，后续可以随时添加环境变量。
```

## 第六步：保存配置并显示摘要

**保存所有配置到文件**

使用 Edit 工具更新配置文件的 YAML frontmatter。

**显示配置摘要**：

```markdown
🎉 配置完成！

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📋 配置摘要

RSS 源：{数量} 个
- {列出源名称}

工作目录：{workspace_root}/

发布平台：
{列出启用的平台}
- ✅ 微信公众号（手动发布）
- ✅ 小红书（手动发布）
- ❌ 飞书（未启用）

API 密钥：
{根据平台列出}
- Minimax: {是否配置环境变量}
- 微信: {是否配置环境变量}

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📝 下一步

1. {如果需要}添加风格参考文章：
   将 2-3 篇你的文章复制到：
   {workspace_root}/style_references/article/

2. {如果需要}配置环境变量：
   参考上面的教程设置 API 密钥

3. 开始创作：
   运行 /content-create:write 开始创作流程

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

💡 管理配置

• 查看配置：重新运行 /content-create:config
• 修改配置：直接编辑 .claude/content-create.local.md
• 重置配置：删除配置文件后重新运行向导

配置文件位置：.claude/content-create.local.md
```

## 配置文件存在时的流程

如果配置文件已存在，使用 AskUserQuestion 询问：

```
问题：配置文件已存在，你想做什么？

选项：
1. 查看当前配置
   - 显示配置摘要

2. 修改配置
   - 进入修改向导

3. 重置配置
   - 恢复默认配置（会备份当前配置）
```

### 选项 1：查看当前配置

读取配置文件，显示格式化的配置摘要（与第六步的摘要格式相同），隐藏 API 密钥敏感信息。

### 选项 2：修改配置

使用 AskUserQuestion 询问要修改的部分：

```
问题：你想修改哪部分配置？

选项：
1. RSS 源
   - 添加/删除/修改 RSS 源

2. 路径设置
   - 更改工作目录

3. 平台设置
   - 启用/禁用平台，设置自动发布

4. 查看 API 密钥配置教程
   - 如何设置环境变量
```

根据选择进入对应的配置流程（复用第二步到第五步的逻辑）。

#### 修改 RSS 源

显示当前 RSS 源列表，使用 AskUserQuestion：

```
当前 RSS 源（{数量} 个）：
1. AI产品洞察日报
2. AI产品创业者-刘小排
3. AI产品创业者-数字生命卡兹克

问题：你想做什么？

选项：
1. 添加新 RSS 源
2. 删除某个 RSS 源
3. 完成修改
```

- **添加**：询问名称和 URL，添加到列表
- **删除**：再次询问删除哪个（显示编号列表）

#### 修改平台设置

显示当前平台状态，使用 AskUserQuestion：

```
当前平台配置：

• 微信公众号：✅ 启用 | 手动发布
• 小红书：✅ 启用 | 手动发布
• 飞书：❌ 未启用

问题：你想修改哪个平台？

选项：
1. 微信公众号
2. 小红书
3. 飞书
4. 完成修改
```

选择平台后，再次询问具体操作：

```
{平台名称} 当前状态：
• 启用状态：{enabled}
• 自动发布：{auto_publish}

问题：你想做什么？

选项：
1. 切换启用状态（当前：{状态}）
2. 切换自动发布（当前：{状态}）
3. 返回
```

### 选项 3：重置配置

先询问确认：

```
问题：确定要重置配置吗？

说明：当前配置会被备份到：
.claude/content-create.local.md.backup

选项：
1. 确认重置
   - 恢复默认配置，当前配置会备份

2. 取消
   - 不做任何修改
```

如果确认：
1. 备份当前配置
2. 复制模板文件
3. 显示重置完成信息
4. 询问是否立即重新配置

## 注意事项

**交互原则**：
1. 每次只问一个问题，不要让用户感到信息过载
2. 提供清晰的选项说明，让用户明白每个选项的含义
3. 使用进度提示（第 X 步/共 N 步），让用户知道还剩多少
4. 提供「跳过」或「稍后配置」选项，降低压力
5. 配置完成后，提供清晰的下一步行动指引

**安全性**：
1. 始终推荐使用环境变量存储 API 密钥
2. 不要在配置文件中硬编码敏感信息
3. 显示 API 密钥时要脱敏处理

**用户体验**：
1. 使用 emoji 让界面友好（但不过度）
2. 每步完成后显示 ✅ 确认
3. 提供示例和推荐选项
4. 错误时给出明确的解决方案

现在开始执行配置向导！
